10 REM YAHTZEE
20 REM
30 REM one of the prize winners in
40 REM the programming competition of magazine
50 REM MSX Computer Magazine
60 REM number 3
70 REM
80 REM Contributor: R.E. Breetveld, Oldebroek
90 REM
100 CLEAR200:COLOR15,1,1:VV=1:NN=9
110 DIM Q(14),R(14),S(14),T(14)
120 OPEN"GRP:"FOROUTPUTAS#1:SCREEN2,2
130 FORI=1TO14:NN=NN+9:Q(I)=NN:R(I)=NN:S(I)=NN:T(I)=NN:NEXTI:GOTO940
140 CLS
150 K=0:M=13*(TP-1)
160 LINE(2,2)-(240,15),15,B
170 LINE(110,17)-(135,142),12,BF
180 LINE(110,145)-(135,154),12,BF
190 LINE(142,17)-(167,142),4,BF
200 LINE(142,145)-(167,154),4,BF
210 LINE(173,17)-(199,142),6,BF
220 LINE(173,145)-(199,154),6,BF
230 LINE(206,17)-(231,142),13,BF
240 LINE(206,145)-(231,154),13,BF
250 FORO=26TO139STEP9:LINE(100,O)-(240,O),1:NEXTO
260 GOSUB 4400
270 DRAW"BM8,18":PRINT#1,"ACESWWWWWWWW"
280 DRAW"BM8,27":PRINT#1,"TWOSWWWWWWWW"
290 DRAW"BM8,36":PRINT#1,"THREESWWWWWW"
300 DRAW"BM8,45":PRINT#1,"FOURSWWWWWWW"
310 DRAW"BM8,54":PRINT#1,"FIVESWWWWWWW"
320 DRAW"BM8,63":PRINT#1,"SIXESWWWWWWW"
330 DRAW"BM8,72":PRINT#1,"TOT+(BONUS)W"
340 DRAW"BM8,81":PRINT#1,"3 OF KINDWWW"
350 DRAW"BM8,90":PRINT#1,"4 OF KINDWWW"
360 DRAW"BM8,99":PRINT#1,"FULL HOUSEWW"
370 DRAW"BM8,108":PRINT#1,"SM STRAIGHTW"
380 DRAW"BM8,117":PRINT#1,"LG STRAIGHTW"
390 DRAW"BM8,126":PRINT#1,"YAHTZEEWWWWW"
400 DRAW"BM8,135":PRINT#1,"CHANCEWWWWWW"
410 DRAW"BM8,147":PRINT#1,"TOTALWWWWWW"
420 T1=0:T2=0:T3=0:T4=0:T5=0:T6=0:K=K+1:IFK>3THENGOSUB910
430 LINE(17,172)-(25,183),1,BF
440 DRAW"BM10,174":PRINT#1,;K
450 DRAW"BM5,164":PRINT#1,"ROLL"
460 DRAW"BM232,164":PRINT#1,"TOT"
470 FORI=1TO5
480 LINE(1+I*40,167)-(23+I*40,190),4,BF
490 PSET(I*40,166),15
500 DRAW"R22D25L22U25"
510 IFC(I)=0THEN520ELSEGOTO900
520 W=INT(RND(1)*10)
530 FORAA=1TOW
540 N=RND(-TIME)
550 Y=INT(6*RND(1)+1)
560 NEXTAA
570 X=Y:TH=0:FO=0:GR=0:LI=0:YA=0:FU=0
580 IFX=1THENGOSUB670
590 IFX=2THENGOSUB690
600 IFX=3THENGOSUB710
610 IFX=4THENGOSUB730
620 IFX=5THENGOSUB750
630 IFX=6THENGOSUB770
640 BEEP:D(I)=X:L(I)=X:NEXTI
650 IFK=0THEN1760
660 GOSUB1200:LINE(3,3)-(103,13),1,BF:GOTO1240
670 CIRCLE(11+I*40,178),2,15,,,1
680 RETURN
690 CIRCLE(17+I*40,171),2,15,,,1:CIRCLE(5+I*40,185),2,15,,,1
700 RETURN
710 GOSUB 670:GOSUB690
720 RETURN
730 CIRCLE(5+I*40,171),2,15,,,1:CIRCLE(17+I*40,185),2,15,,,1:GOSUB 690
740 RETURN
750 GOSUB670:GOSUB730
760 RETURN
770 CIRCLE(11+I*40,171),2,15,,,1:CIRCLE(11+I*40,185),2,15,,,1:GOSUB 730
780 RETURN
790 GOSUB 1180
800 A$=INKEY$
810 IFA$=" "THEN420
820 IFA$="0"THENGOSUB1180:PLAY"A"
830 IFA$="1"THENC(1)=D(1):BEEP:GOSUB4580
840 IFA$="2"THENC(2)=D(2):BEEP:GOSUB4600
850 IFA$="3"THENC(3)=D(3):BEEP:GOSUB4620
860 IFA$="4"THENC(4)=D(4):BEEP:GOSUB4640
870 IFA$="5"THENC(5)=D(5):BEEP:GOSUB4660
880 IFA$="i"THENGOSUB1800:K=4:GOSUB420
890 IFA$="I"THENGOSUB1800:K=4:GOSUB420ELSE800
900 X=C(I):GOTO 580
910 C(1)=0:C(2)=0:C(3)=0:C(4)=0:C(5)=0:C(6)=0
920 D(1)=0:D(2)=0:D(3)=0:D(4)=0:D(5)=0:D(6)=0
930 K=1:RETURN
940 COLOR15,1,1:PSET(10,40),15
950 DRAW"D10R2F10D10L2D10R10U10L2U10E10R2U10L10D10R2G7H7R2U10L10"
960 PSET(45,50),15
970 DRAW"D20L2D10R10U10L2U5R10D5L2D10R10U10L2U20H11G11"
980 PSET(51,53),15
990 DRAW"D8R10U8H5G5"
1000 PSET(72,40),15
1010 DRAW"D10R2D20L2D10R10U10L2U8R15D8L2D10R10U10L2U20R2U10L10D10R2D8L15U8R2U10L10"
1020 PSET(108,40),15
1030 DRAW"D10R10U2R3D22L2D10R10U10L2U22R3D2R10U10L32"
1040 PSET(143,40),15
1050 DRAW"D10R10U2R13G22D10R30U10L10D2L13E22U10L30"
1060 PSET(178,40),15
1070 DRAW"D40R30U10L10D2L12U9R8D2R10U10L10D2L8U9R12D2R10U10L30"
1080 PSET(212,40),15
1090 DRAW"D40R30U10L10D2L12U9R8D2R10U10L10D2L8U9R12D2R10U10L30"
1100 LINE(6,90)-(250,98),15,B
1110 DRAW"BM50,110":PRINT#1,"COPYRIGHT   MAY 1985"
1120 CIRCLE(135,113),4,15,,,1
1130 DRAW"BM133,109":PRINT#1,"c"
1140 DRAW"BM80,125":PRINT#1,"R.E.Breetveld."
1150 LINE(80,134)-(190,134),15
1160 GOSUB470
1170 GOTO1170
1180 LINE(40,164)-(223,159),1,BF:FORI=1TO 6:C(I)=0:NEXTI:RETURN
1190 NEXT I RETURN
1200 Q=L(1)+L(2)+L(3)+L(4)+L(5)+L(6)
1210 LINE(235,174)-(254,185),1,BF
1220 DRAW"BM227,175":PRINT#1,;Q
1230 RETURN
1240 REM FORI=1TO6:L(I)=D(I):NEXTI
1250 GOSUB1420:GOSUB1450:GOSUB1480:GOSUB1510:GOSUB1540:GOSUB1570
1260 IFT1=3ANDT2=4ORT1=3ANDT3=6ORT1=3ANDT4=8ORT1=3ANDT5=10ORT1=3ANDT6=12THEN1720
1270 IFT2=6ANDT1=2ORT2=6ANDT3=6ORT2=6ANDT4=8ORT2=6ANDT5=10ORT2=6ANDT6=12THEN1720
1280 IFT3=9ANDT2=4ORT3=9ANDT1=2ORT3=9ANDT4=8ORT3=9ANDT5=10ORT3=9ANDT6=12THEN1720
1290 IFT4=12ANDT2=4ORT4=12ANDT3=6ORT4=12ANDT1=2ORT4=12ANDT5=10ORT4=12ANDT6=12THEN1720
1300 IFT5=15ANDT2=4ORT5=15ANDT3=6ORT5=15ANDT4=8ORT5=15ANDT1=2ORT5=15ANDT6=12THEN1720
1310 IFT6=18ANDT2=4ORT6=18ANDT3=6ORT6=18ANDT4=8ORT6=18ANDT5=10ORT6=18ANDT1=2THEN1720
1320 IFT1/3=1ORT2/3=2ORT3/3=3ORT4/3=4ORT5/3=5ORT6/3=6THEN1600
1330 IFT1/4=1ORT2/4=2ORT3/4=3ORT4/4=4ORT5/4=5ORT6/4=6THEN1640
1340 IFT1=1ANDT2=2ANDT3=3ANDT4=4ANDT5=5ANDT6=0THEN1660
1350 IFT1=0ANDT2=2ANDT3=3ANDT4=4ANDT5=5ANDT6=6THEN1660
1360 IFT1>0ANDT2>0ANDT3>0ANDT4>0THEN1700
1370 IFT2>0ANDT3>0ANDT4>0ANDT5>0THEN1700
1380 IFT3>0ANDT4>0ANDT5>0ANDT6>0THEN1700
1390 IFT2=2ANDT3=3ANDT4=4ANDT5=5THEN1700
1400 IFT1/5=1ORT2/5=2ORT3/5=3ORT4/5=4ORT5/5=5ORT6/5=6THEN1680ELSE1620
1410 GOTO1410
1420 FORI=1TO5
1430 IFL(I)=1THENA1=A1+1:T1=1*A1
1440 NEXTI:RETURN
1450 FORI=1TO5
1460 IFL(I)=2THENA2=A2+1:T2=2*A2
1470 NEXTI:RETURN
1480 FORI=1TO5
1490 IFL(I)=3THENA3=A3+1:T3=3*A3
1500 NEXTI:RETURN
1510 FORI=1TO5
1520 IFL(I)=4THENA4=A4+1:T4=4*A4
1530 NEXTI:RETURN
1540 FORI=1TO5
1550 IFL(I)=5THENA5=A5+1:T5=5*A5
1560 NEXTI:RETURN
1570 FORI=1TO5
1580 IFL(I)=6THENA6=A6+1:T6=6*A6
1590 NEXTI:RETURN
1600 DRAW"BM8,6":PRINT#1,"3 OF A KIND"
1610 TH=1:GOTO1740
1620 DRAW"BM8,6":PRINT#1,"************"
1630 GOTO1740
1640 DRAW"BM8,6":PRINT#1,"4 OF A KIND"
1650 FO=1:GOTO1740
1660 DRAW"BM8,6":PRINT#1,"LG STRAIGHT"
1670 GR=1:GOTO1740
1680 PLAY"T255O5CFBCFBCFB":DRAW"BM8,6":PRINT#1,"YAHTZEE !!!"
1690 YA=1:GOSUB4690:GOTO1740
1700 DRAW"BM8,6":PRINT#1,"SM STRAIGHT"
1710 LI=1:GOTO1740
1720 DRAW"BM8,6":PRINT#1,"FULL HOUSE"
1730 FU=1:GOTO1740
1740 GOSUB1780:A1=0:A2=0:A3=0:A4=0:A5=0:A6=0
1750 FORI=1TO6:L(I)=0:NEXTI:GOTO790
1760 FORW=1TO1500
1770 NEXTW:GOTO4320
1780 IFK=3THENGOTO1800ELSE1790
1790 RETURN
1800 SPRITE$(1)=CHR$(28)+CHR$(30)+CHR$(31)+CHR$(30)+CHR$(28)
1810 SPRITE$(2)=CHR$(28)+CHR$(30)+CHR$(31)+CHR$(30)+CHR$(28)
1820 SPRITE$(3)=CHR$(28)+CHR$(30)+CHR$(31)+CHR$(30)+CHR$(28)
1830 SPRITE$(4)=CHR$(28)+CHR$(30)+CHR$(31)+CHR$(30)+CHR$(28)
1840 UP=81
1850 PUTSPRITE1,(102,UP),15,1
1860 PUTSPRITE2,(134,UP),15,1
1870 PUTSPRITE3,(165,UP),15,1
1880 PUTSPRITE4,(198,UP),15,1
1890 ST=STICK(0)
1900 IFUP>140THENUP=135
1910 IFUP<18THENUP=18
1920 IFST=5THENUP=UP+9:FORD=1TO25:NEXTD:BEEP
1930 IFST=1THENUP=UP-9:FORD=1TO25:NEXTD:BEEP
1940 IFUP=72THEN1920
1950 IFST=3THEN4250ELSE1850
1960 X1=T1:DRAW"BM105,18":PRINT#1,;X1
1970 Q(1)=0:GOTO3550
1980 X2=T2:DRAW"BM105,27":PRINT#1,;X2
1990 Q(2)=0:GOTO3550
2000 X3=T3:DRAW"BM105,36":PRINT#1,;X3
2010 Q(3)=0:GOTO3550
2020 X4=T4:DRAW"BM105,45":PRINT#1,;X4
2030 Q(4)=0:GOTO3550
2040 X5=T5:DRAW"BM105,54":PRINT#1,;X5
2050 Q(5)=0:GOTO3550
2060 X6=T6:DRAW"BM105,63":PRINT#1,;X6
2070 Q(6)=0:GOTO3550
2080 LINE(110,72)-(135,79),12,BF
2090 IFTX>62THENTX=TX+35
2100 X7=TX:DRAW"BM105,72":PRINT#1,X7
2110 RETURN
2120 X8=0:IFYA>0ORFO>0ORTH>0ORFU>0THENX8=Q
2130 DRAW"BM105,81":PRINT#1,;X8
2140 Q(8)=0:GOTO3550
2150 X9=0:IFYA>0ORFO>0THENX9=Q
2160 DRAW"BM105,90":PRINT#1,;X9
2170 Q(9)=0:GOTO3550
2180 XA=0:IFFU>0ORYA>0THENXA=25
2190 DRAW"BM105,99":PRINT#1,;XA
2200 Q(10)=0:GOTO3550
2210 XB=0:IFLI>0ORGR>0ORYA>0THENXB=30
2220 DRAW"BM105,108":PRINT#1,;XB
2230 Q(11)=0:GOTO3550
2240 XC=0:IFGR>0ORYA>0THENXC=40
2250 DRAW"BM105,117":PRINT#1,;XC
2260 Q(12)=0:GOTO3550
2270 XD=0:IFYA>0THENXD=50
2280 DRAW"BM105,126":PRINT#1,;XD
2290 Q(13)=0:GOTO3550
2300 XE=Q
2310 DRAW"BM105,136":PRINT#1,;XE
2320 Q(14)=0:GOTO3550
2330 DRAW"BM105,147":PRINT#1,;XF
2340 GOTO3550
2350 REM ********* SP2**********
2360 Y1=T1:DRAW"BM136,18":PRINT#1,;Y1
2370 R(1)=0:GOTO3550
2380 Y2=T2:DRAW"BM136,27":PRINT#1,;Y2
2390 R(2)=0:GOTO3550
2400 Y3=T3:DRAW"BM136,36":PRINT#1,;Y3
2410 R(3)=0:GOTO3550
2420 Y4=T4:DRAW"BM136,45":PRINT#1,;Y4
2430 R(4)=0:GOTO3550
2440 Y5=T5:DRAW"BM136,54":PRINT#1,;Y5
2450 R(5)=0:GOTO3550
2460 Y6=T6:DRAW"BM136,63":PRINT#1,;Y6
2470 R(6)=0:GOTO3550
2480 LINE(142,72)-(167,79),4,BF
2490 IFTY>62THENTY=TY+35
2500 Y7=TY:DRAW"BM136,72":PRINT#1,Y7
2510 RETURN
2520 Y8=0:IFYA>0ORFO>0ORTH>0ORFU>0THENY8=Q
2530 DRAW"BM136,81":PRINT#1,;Y8
2540 R(8)=0:GOTO3550
2550 Y9=0:IFYA>0ORFO>0THENY9=Q
2560 DRAW"BM136,90":PRINT#1,;Y9
2570 R(9)=0:GOTO3550
2580 YB=0:IFFU>0ORYA>0THENYB=25
2590 DRAW"BM136,99":PRINT#1,;YB
2600 R(10)=0:GOTO3550
2610 YC=0:IFLI>0ORGR>0ORYA>0THENYC=30
2620 DRAW"BM136,108":PRINT#1,;YC
2630 R(11)=0:GOTO3550
2640 YD=0:IFGR>0ORYA>0THENYD=40
2650 DRAW"BM136,117":PRINT#1,;YD
2660 R(12)=0:GOTO3550
2670 YE=0:IFYA>0THENYE=50
2680 DRAW"BM136,126":PRINT#1,;YE
2690 R(13)=0:GOTO3550
2700 YF=Q
2710 DRAW"BM136,135":PRINT#1,;YF
2720 R(14)=0:GOTO3550
2730 DRAW"BM136,147":PRINT#1,;YG
2740 GOTO3550
2750 REM ********* SP3 *********
2760 Z1=T1:DRAW"BM168,18":PRINT#1,;Z1
2770 S(1)=0:GOTO3550
2780 Z2=T2:DRAW"BM168,27":PRINT#1,;Z2
2790 S(2)=0:GOTO3550
2800 Z3=T3:DRAW"BM168,36":PRINT#1,;Z3
2810 S(3)=0:GOTO3550
2820 Z4=T4:DRAW"BM168,45":PRINT#1,;Z4
2830 S(4)=0:GOTO3550
2840 Z5=T5:DRAW"BM168,54":PRINT#1,;Z5
2850 S(5)=0:GOTO3550
2860 Z6=T6:DRAW"BM168,63":PRINT#1,;Z6
2870 S(6)=0:GOTO3550
2880 LINE(173,72)-(199,79),6,BF
2890 IFTZ>62THENTZ=TZ+35
2900 Z7=TZ:DRAW"BM168,72":PRINT#1,Z7
2910 RETURN
2920 Z8=0:IFYA>0ORFO>0ORTH>0ORFU>0THENZ8=Q
2930 DRAW"BM168,81":PRINT#1,;Z8
2940 S(8)=0:GOTO3550
2950 Z9=0:IFYA>0ORFO>0THENZ9=Q
2960 DRAW"BM168,90":PRINT#1,;Z9
2970 S(9)=0:GOTO3550
2980 ZA=0:IFFU>0ORYA>0THENZA=25
2990 DRAW"BM168,99":PRINT#1,;ZA
3000 S(10)=0:GOTO3550
3010 ZB=0:IFLI>0ORGR>0ORYA>0THENZB=30
3020 DRAW"BM168,108":PRINT#1,;ZB
3030 S(11)=0:GOTO3550
3040 ZC=0:IFGR>0ORYA>0THENZC=40
3050 DRAW"BM168,117":PRINT#1,;ZC
3060 S(12)=0:GOTO3550
3070 ZD=0:IFYA>0THENZD=50
3080 DRAW"BM168,126":PRINT#1,;ZD
3090 S(13)=0:GOTO3550
3100 ZE=Q
3110 DRAW"BM168,135":PRINT#1,;ZE
3120 S(14)=0:GOTO3550
3130 DRAW"BM168,147":PRINT#1,;ZF
3140 GOTO 3550
3150 REM ********* SP4**********
3160 Q1=T1:DRAW"BM200,18":PRINT#1,;Q1
3170 T(1)=0:GOTO3550
3180 Q2=T2:DRAW"BM200,27":PRINT#1,;Q2
3190 T(2)=0:GOTO3550
3200 Q3=T3:DRAW"BM200,36":PRINT#1,;Q3
3210 T(3)=0:GOTO3550
3220 Q4=T4:DRAW"BM200,45":PRINT#1,;Q4
3230 T(4)=0:GOTO3550
3240 Q5=T5:DRAW"BM200,54":PRINT#1,;Q5
3250 T(5)=0:GOTO3550
3260 Q6=T6:DRAW"BM200,63":PRINT#1,;Q6
3270 T(6)=0:GOTO3550
3280 LINE(206,72)-(231,79),13,BF
3290 IFTQ>62THENTQ=TQ+35
3300 Q7=TQ:DRAW"BM200,72":PRINT#1,Q7
3310 RETURN
3320 Q8=0:IFYA>0ORFO>0ORTH>0ORFU>0THENQ8=Q
3330 DRAW"BM200,81":PRINT#1,;Q8
3340 T(8)=0:GOTO3550
3350 Q9=0:IFYA>0ORFO>0THENQ9=Q
3360 DRAW"BM200,90":PRINT#1,;Q9
3370 T(9)=0:GOTO3550
3380 QA=0:IFFU>0ORYA>0THENQA=25
3390 DRAW"BM200,99":PRINT#1,;QA
3400 T(10)=0:GOTO3550
3410 QB=0:IFLI>0ORGR>0ORYA>0THENQB=30
3420 DRAW"BM200,108":PRINT#1,;QB
3430 T(11)=0:GOTO3550
3440 QC=0:IFGR>0ORYA>0THENQC=40
3450 DRAW"BM200,117":PRINT#1,;QC
3460 T(12)=0:GOTO3550
3470 QD=0:IFYA>0THENQD=50
3480 DRAW"BM200,126":PRINT#1,;QD
3490 T(13)=0:GOTO3550
3500 QE=Q
3510 DRAW"BM200,135":PRINT#1,;QE
3520 T(14)=0:GOTO3550
3530 DRAW"BM200,147":PRINT#1,;QF
3540 GOTO3550
3550 TX=X1+X2+X3+X4+X5+X6:GOSUB2080
3560 TY=Y1+Y2+Y3+Y4+Y5+Y6:GOSUB2480
3570 TZ=Z1+Z2+Z3+Z4+Z5+Z6:GOSUB2880
3580 TQ=Q1+Q2+Q3+Q4+Q5+Q6:GOSUB3280
3590 G=G+1
3600 IFG=MTHEN4480
3610 LINE(110,3)-(238,13),1,BF:
3620 VV=VV+1
3630 IFVV=TPTHENVV=1
3640 IFVV=1THEN4400
3650 IFVV=2THEN4420
3660 IFVV=3THEN4440
3670 IFVV=4THEN4460
3680 RETURN
3690 IFUP=Q(1)THENGOTO1960
3700 IFUP=Q(2)THENGOTO1980
3710 IFUP=Q(3)THENGOTO2000
3720 IFUP=Q(4)THENGOTO2020
3730 IFUP=Q(5)THENGOTO2040
3740 IFUP=Q(6)THENGOTO2060
3750 IFUP=Q(8)THENGOTO2120
3760 IFUP=Q(9)THENGOTO2150
3770 IFUP=Q(10)THENGOTO2180
3780 IFUP=Q(11)THENGOTO2210
3790 IFUP=Q(12)THENGOTO2240
3800 IFUP=Q(13)THENGOTO2270
3810 IFUP=Q(14)THENGOTO2300
3820 GOTO4680
3830 IFUP=R(1)THENGOTO2360
3840 IFUP=R(2)THENGOTO2380
3850 IFUP=R(3)THENGOTO2400
3860 IFUP=R(4)THENGOTO2420
3870 IFUP=R(5)THENGOTO2440
3880 IFUP=R(6)THENGOTO2460
3890 IFUP=R(8)THENGOTO2520
3900 IFUP=R(9)THENGOTO2550
3910 IFUP=R(10)THENGOTO2580
3920 IFUP=R(11)THENGOTO2610
3930 IFUP=R(12)THENGOTO2640
3940 IFUP=R(13)THENGOTO2670
3950 IFUP=R(14)THENGOTO2700
3960 GOTO4680
3970 IFUP=S(1)THENGOTO2760
3980 IFUP=S(2)THENGOTO2780
3990 IFUP=S(3)THENGOTO2800
4000 IFUP=S(4)THENGOTO2820
4010 IFUP=S(5)THENGOTO2840
4020 IFUP=S(6)THENGOTO2860
4030 IFUP=S(8)THENGOTO2920
4040 IFUP=S(9)THENGOTO2950
4050 IFUP=S(10)THENGOTO2980
4060 IFUP=S(11)THENGOTO3010
4070 IFUP=S(12)THENGOTO3040
4080 IFUP=S(13)THENGOTO3070
4090 IFUP=S(14)THENGOTO3100
4100 GOTO4680
4110 IFUP=T(1)THENGOTO3160
4120 IFUP=T(2)THENGOTO3180
4130 IFUP=T(3)THENGOTO3200
4140 IFUP=T(4)THENGOTO3220
4150 IFUP=T(5)THENGOTO3240
4160 IFUP=T(6)THENGOTO3260
4170 IFUP=T(8)THENGOTO3320
4180 IFUP=T(9)THENGOTO3350
4190 IFUP=T(10)THENGOTO3380
4200 IFUP=T(11)THENGOTO3410
4210 IFUP=T(12)THENGOTO3440
4220 IFUP=T(13)THENGOTO3470
4230 IFUP=T(14)THENGOTO3500
4240 GOTO4680
4250 DD=DD+1
4260 IFDD=TPTHENDD=1
4270 IFDD=1THEN3690
4280 IFDD=2THEN3830
4290 IFDD=3THEN3970
4300 IFDD=4THEN4110
4310 GOTO4260
4320 CLS:DRAW"BM55,95":PRINT#1,"HOW MANY PLAYERS ?"
4330 DRAW"BM75,105":PRINT#1,"MAX 4"
4340 A$=INKEY$
4350 IFA$="1"THENTP=2:GOTO140
4360 IFA$="2"THENTP=3:GOTO140
4370 IFA$="3"THENTP=4:GOTO140
4380 IFA$="4"THENTP=5:GOTO140ELSE4340
4390 GOTO4340
4400 DRAW"BM112,6":PRINT#1,"PLY1"
4410 RETURN
4420 DRAW"BM143,6":PRINT#1,"PLY2"
4430 RETURN
4440 DRAW"BM175,6":PRINT#1,"PLY3"
4450 RETURN
4460 DRAW"BM207,6":PRINT#1,"PLY4"
4470 RETURN
4480 XF=X1+X2+X3+X4+X5+X6+X7+X8+X9+XA+XB+XC+XD+XE
4490 YG=Y1+Y2+Y3+Y4+Y5+Y6+Y7+Y8+Y9+YB+YC+YD+YE+YF
4500 ZF=Z1+Z2+Z3+Z4+Z5+Z6+Z7+Z8+Z9+ZA+ZB+ZC+ZD+ZE
4510 QF=Q1+Q2+Q3+Q4+Q5+Q6+Q7+Q8+Q9+QA+QB+QC+QD+QE
4520 DRAW"BM105,147":PRINT#1,;XF
4530 DRAW"BM136,147":PRINT#1,;YG
4540 DRAW"BM168,147":PRINT#1,;ZF
4550 DRAW"BM200,147":PRINT#1,;QF
4560 A$=INKEY$
4570 IFA$=" "THEN100ELSE4560
4580 LINE(40,162)-(62,159),10,BF
4590 RETURN
4600 LINE(80,162)-(102,159),10,BF
4610 RETURN
4620 LINE(120,162)-(142,159),10,BF
4630 RETURN
4640 LINE(160,162)-(182,159),10,BF
4650 RETURN
4660 LINE(200,162)-(222,159),10,BF
4670 RETURN
4680 PLAY"GC":DD=DD-1:GOTO1890
4690 IFVV=1ANDXD>20THEN4740
4700 IFVV=2ANDYE>20THEN4780
4710 IFVV=3ANDZD>20THEN4820
4720 IFVV=4ANDQD>20THEN4860
4730 RETURN
4740 LINE(110,133)-(135,126),12,BF
4750 XD=XD+100
4760 DRAW"BM105,126":PRINT#1,;XD
4770 RETURN
4780 LINE(142,133)-(167,126),4,BF
4790 YE=YE+100
4800 DRAW"BM136,126":PRINT#1,;YE
4810 RETURN
4820 LINE(173,133)-(199,126),6,BF
4830 ZD=ZD+100
4840 DRAW"BM168,126":PRINT#1,;ZD
4850 RETURN
4860 LINE(206,133)-(231,126),13,BF
4870 QD=QD+100
4880 DRAW"BM200,126":PRINT#1,;QD
4890 RETURN
